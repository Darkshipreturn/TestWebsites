<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="https://pbsi.xyz/style.css">
    <title>Player Stats</title>
    <script>
        async function fetchProfileData(name) {
            const profileCard = document.createElement('div');
            profileCard.classList.add('profile-card');
            profileCard.style = "background-color: black; padding: 15px; margin: 10px; border-radius: 10px; box-shadow: 0px 4px 10px grey; width: 150px; text-align: center;";
            
            const profileSkin = document.createElement('img');
            profileSkin.src = 'https://crafatar.com/avatars/00000000-0000-0000-0000-000000000000?overlay'; // Default avatar placeholder
            profileSkin.alt = name;
            profileSkin.width = 50;
            profileSkin.height = 50;
            profileSkin.style = "border-radius: 5px; margin-bottom: 10px;";
            profileCard.appendChild(profileSkin);

            const nameElement = document.createElement('h4');
            nameElement.textContent = name;
            profileCard.appendChild(nameElement);
            
            const killsElement = document.createElement('p');
            killsElement.textContent = 'Kills: Loading...';
            profileCard.appendChild(killsElement);

            const deathsElement = document.createElement('p');
            deathsElement.textContent = 'Deaths: Loading...';
            profileCard.appendChild(deathsElement);

            document.getElementById('randomProfiles').appendChild(profileCard);
            
            try {
                // Check Java Edition UUID
                let uuidResponse = await fetch(`https://api.ashcon.app/mojang/v2/user/${name}`);
                if (uuidResponse.ok) {
                    let uuidData = await uuidResponse.json();
                    if (uuidData.uuid) {
                        profileSkin.src = `https://crafatar.com/avatars/${uuidData.uuid}?overlay`;
                    }
                } else {
                    // Check Bedrock Edition (uses external service)
                    uuidResponse = await fetch(`https://playerdb.co/api/player/minecraft/${name}`);
                    let bedrockData = await uuidResponse.json();
                    if (bedrockData.success && bedrockData.data.player.id) {
                        profileSkin.src = `https://mc-heads.net/avatar/${bedrockData.data.player.id}`;
                    }
                }
            } catch (error) {
                console.error('Failed to load player skin:', error);
            }

            try {
                const killsResponse = await fetch(`https://api.antiskeppy.xyz/public/kills/${name}`);
                if (killsResponse.ok) {
                    const killsData = await killsResponse.json();
                    killsElement.textContent = `Kills: ${killsData.kills || 0}`;
                }
            } catch (error) {
                killsElement.textContent = 'Kills: N/A';
            }
            
            try {
                const deathsResponse = await fetch(`https://api.antiskeppy.xyz/public/deaths/${name}`);
                if (deathsResponse.ok) {
                    const deathsData = await deathsResponse.json();
                    deathsElement.textContent = `Deaths: ${deathsData.deaths || 0}`;
                }
            } catch (error) {
                deathsElement.textContent = 'Deaths: N/A';
            }
        }

        function fetchRandomProfiles() {
            const randomProfiles = ['Antiskeppy', 'Pbsi', 'Speedyshan28'];
            document.getElementById('randomProfiles').innerHTML = '';
            randomProfiles.forEach(fetchProfileData);
        }

        function handleSearch() {
            const name = document.getElementById('search').value;
            if (!name) return;

            const urlParams = new URLSearchParams(window.location.search);
            urlParams.set('name', name);
            window.history.replaceState({}, '', `${window.location.pathname}?${urlParams}`);
            
            document.getElementById('randomProfiles').innerHTML = '';
            fetchProfileData(name);
        }

        window.onload = () => {
            fetchRandomProfiles();
        };
    </script>
</head>
<body style="display: flex; flex-direction: column; align-items: center; background-color: black; color: white; text-align: center;">
    <div style="background-color: #222; width: 100%; padding: 15px 0; display: flex; justify-content: center; position: sticky; top: 0; z-index: 10;">
        <a href="/" style="color: white; font-size: 1.2rem; text-decoration: none; margin: 0 20px;">Home</a>
        <a href="kill-leaderboard.html" style="color: white; font-size: 1.2rem; text-decoration: none; margin: 0 20px;">Kill-Leaderboard</a>
    </div>
    <div style="margin-bottom: 20px; position: sticky; top: 60px; z-index: 9; background-color: black; padding: 10px 0;">
        <input type="text" id="search" placeholder="Enter Minecraft username" style="padding: 10px; font-size: 1rem; width: 250px; margin-right: 10px;">
        <button onclick="handleSearch()" style="padding: 10px 15px; background-color: limegreen; color: white; border: none;">Search</button>
    </div>
    <div id="randomProfiles" style="display: flex; flex-wrap: wrap; justify-content: center; margin-top: 20px; width: 100%;"></div>
</body>
</html>
